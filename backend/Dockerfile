FROM node:18.20.8

# T·∫°o th∆∞ m·ª•c l√†m vi·ªác
WORKDIR /clothingstore/backend

# Copy package.json v√† c√†i th∆∞ vi·ªán
COPY package*.json ./
RUN npm install && npm install -g @babel/core @babel/cli

# Copy to√†n b·ªô m√£ ngu·ªìn
COPY . .

# Build source t·ª´ src ‚Üí build/
RUN npm run build-src

# Ch·∫°y server (ƒë√∫ng d√≤ng n√†y m·ªõi gi·ªØ container s·ªëng)
CMD ["node", "build/server.js"]

#docker build --tag node-docker .
#docker run -p 3000:3000 node-docker


# # ‚ö†Ô∏è C√†i th√™m sqlcmd ƒë·ªÉ backend c√≥ th·ªÉ ki·ªÉm tra MSSQL
# RUN apt-get update && \
#     apt-get install -y curl apt-transport-https gnupg && \
#     curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add - && \
#     curl https://packages.microsoft.com/config/debian/10/prod.list -o /etc/apt/sources.list.d/mssql-release.list && \
#     apt-get update && \
#     ACCEPT_EULA=Y apt-get install -y mssql-tools unixodbc-dev && \
#     ln -s /opt/mssql-tools/bin/* /usr/local/bin/

# # üü¢ Copy script ki·ªÉm tra DB t·ªìn t·∫°i
# COPY wait-for-db.sh /wait-for-db.sh
# RUN chmod +x /wait-for-db.sh

# CMD ["/bin/bash", "/wait-for-db.sh"]
